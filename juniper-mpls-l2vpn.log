Configuration MPLS L2VPN Service Juniper vMX

[Interface Configuration Trunk Node 11-CE]
set interfaces ge-0/0/1 flexible-vlan-tagging
set interfaces ge-0/0/1 mtu 1900
set interfaces ge-0/0/1 encapsulation flexible-ethernet-services
set interfaces ge-0/0/1 unit 10 description L2VPN
set interfaces ge-0/0/1 unit 10 encapsulation vlan-ccc
set interfaces ge-0/0/1 unit 10 vlan-id 10

[L2VPN Configuration Node 11-CE]
set protocols l2circuit neighbor 21.21.21.21 interface ge-0/0/1.10 virtual-circuit-id 10
set protocols l2circuit neighbor 21.21.21.21 interface ge-0/0/1.10 description L2VPN
set protocols l2circuit neighbor 21.21.21.21 interface ge-0/0/1.10 no-control-word
set protocols l2circuit neighbor 21.21.21.21 interface ge-0/0/1.10 ignore-encapsulation-mismatch

[Interface Configuration Trunk Node 11-CE]
set interfaces ge-0/0/1 flexible-vlan-tagging
set interfaces ge-0/0/1 mtu 1900
set interfaces ge-0/0/1 encapsulation flexible-ethernet-services
set interfaces ge-0/0/1 unit 10 description L2VPN
set interfaces ge-0/0/1 unit 10 encapsulation vlan-ccc
set interfaces ge-0/0/1 unit 10 vlan-id 10

[L2VPN Configuration Node 11-CE]
set protocols l2circuit neighbor 11.11.11.11 interface ge-0/0/1.10 virtual-circuit-id 10
set protocols l2circuit neighbor 11.11.11.11 interface ge-0/0/1.10 description L2VPN
set protocols l2circuit neighbor 11.11.11.11 interface ge-0/0/1.10 no-control-word
set protocols l2circuit neighbor 11.11.11.11 interface ge-0/0/1.10 ignore-encapsulation-mismatch

[Verification L2VPN Services Node 11-CE]
jncia@11-CE# run show l2circuit connections up | grep ge-0/0/1.10
    ge-0/0/1.10(vc 10)        rmt   Up     Aug 23 02:05:57 2024           1
      Local interface: ge-0/0/1.10, Status: Up, Encapsulation: VLAN
[edit]
jncia@11-CE#

[Verification L2VPN Services Node 21-CE]
jncia@21-CE# run show l2circuit connections up | grep ge-0/0/1.10
    ge-0/0/1.10(vc 10)        rmt   Up     Aug 23 09:04:30 2024           1
      Local interface: ge-0/0/1.10, Status: Up, Encapsulation: VLAN
[edit]
jncia@21-CE#

[Verification Node Y]
NODE-Y> show ip
NAME        : NODE-Y[1]
IP/MASK     : 192.0.0.2/30
GATEWAY     : 192.0.0.1
DNS         :
MAC         : 00:50:79:66:68:20
LPORT       : 20000
RHOST:PORT  : 127.0.0.1:30000
MTU         : 1500
NODE-Y> ping 192.0.0.1
84 bytes from 192.0.0.1 icmp_seq=1 ttl=64 time=13.315 ms
84 bytes from 192.0.0.1 icmp_seq=2 ttl=64 time=15.327 ms
84 bytes from 192.0.0.1 icmp_seq=3 ttl=64 time=13.728 ms
84 bytes from 192.0.0.1 icmp_seq=4 ttl=64 time=13.390 ms
84 bytes from 192.0.0.1 icmp_seq=5 ttl=64 time=15.021 ms
NODE-Y> trace 192.0.0.1
trace to 192.0.0.1, 8 hops max, press Ctrl+C to stop
 1   *192.0.0.1   27.749 ms (ICMP type:3, code:3, Destination port unreachable)
NODE-Y>

[Verification Node X]
NODE-X> show ip
NAME        : NODE-X[1]
IP/MASK     : 192.0.0.1/30
GATEWAY     : 192.0.0.2
DNS         :
MAC         : 00:50:79:66:68:1f
LPORT       : 20000
RHOST:PORT  : 127.0.0.1:30000
MTU         : 1500
NODE-X> ping 192.0.0.2
84 bytes from 192.0.0.2 icmp_seq=1 ttl=64 time=15.295 ms
84 bytes from 192.0.0.2 icmp_seq=2 ttl=64 time=19.358 ms
84 bytes from 192.0.0.2 icmp_seq=3 ttl=64 time=14.947 ms
84 bytes from 192.0.0.2 icmp_seq=4 ttl=64 time=12.924 ms
84 bytes from 192.0.0.2 icmp_seq=5 ttl=64 time=14.149 ms
NODE-X> trace 192.0.0.2
trace to 192.0.0.2, 8 hops max, press Ctrl+C to stop
 1   *192.0.0.2   16.742 ms (ICMP type:3, code:3, Destination port unreachable)
NODE-X>




